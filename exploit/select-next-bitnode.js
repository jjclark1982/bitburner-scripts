export async function main(ns) {
    let bitnodeNumber = ns.args[0] || 12;
    setTimeout(()=>{
        selectNextBitnode(bitnodeNumber);
    }, 0);
}

async function selectNextBitnode(n) {
    let button = await waitForButton(`BitNode-${n}`);
    button.click();

    button = await waitForButton(`enter-bitnode-${n}`);
    button.click();
}

async function waitForButton(label) {
    const doc = eval("document");
    let button = doc.querySelector(`[aria-label*="${label}"]`);
    while (!button) {
        await sleep(1000);
        button = doc.querySelector(`[aria-label*="${label}"]`);
    }
    return button;
}

function sleep(ms) {
    return new Promise((resolve) => setTimeout(resolve, ms));
}
